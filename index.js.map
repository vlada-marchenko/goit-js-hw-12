{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\"\nimport \"simplelightbox/dist/simple-lightbox.min.css\"\n\nexport const gallery = document.querySelector('.gallery')\nexport let lightbox = new SimpleLightbox('.gallery a')\n\nexport default function createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n    `\n    <li class=\"pic\">\n      <a href=\"${largeImageURL}\" target=\"_blank\">\n        <div class=\"pic-card\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"100%\" height=\"220px\"/>\n          <div class=\"info\">\n            <p class=\"info-item\"><b> <span>Likes</span></b> ${likes}</p>\n            <p class=\"info-item\"><b> <span>Views</span></b> ${views}</p>\n            <p class=\"info-item\"><b> <span>Comments</span></b> ${comments}</p>\n            <p class=\"info-item\"><b> <span>Downloads</span></b> ${downloads}</p>\n          </div>\n        </div>\n      </a>\n    </li>\n    `\n    ).join(''); \n}\n\n\nexport function renderGallery(arr) {\n  const markup = createMarkup(arr);\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}","import axios from \"axios\"\nimport createMarkup, { gallery } from './render-functions.js';\n\nexport const input = document.querySelector('.input')\nexport let page = 1\nexport let perPage = 15\nexport let totalPages = 0\n\nexport function resetPage() {\n    page = 1\n}\n\nconst api_key = __PIXABAY_API_KEY__\n\n\nexport default async function request(query, currentPage) {\n    if(!query) {\n        return Promise.resolve([])\n    }\n\n    // if (totalPages !== 0 && currentPage > totalPages) {\n    //     return Promise.resolve([]);\n    // }\n\n    try {\n    const fetch = await axios.get('https://pixabay.com/api/', {\n        params: {\n        key: api_key,\n        q: query.toLowerCase(),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: perPage\n        }\n    })\n\n    const totalHits = fetch.data.totalHits\n    totalPages = Math.ceil(totalHits / perPage)\n\n    //  if (currentPage > totalPages) {\n    //   return []\n    // }\n\n    return fetch.data.hits\n} catch(err)  {\n        return []\n}\n}","import request, { input, page, perPage, totalPages, resetPage } from \"./js/pixabay-api.js\";\nimport createMarkup, { gallery, renderGallery } from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst button_search = document.querySelector('.button')\nconst form = document.querySelector('.form')\nconst loader = document.querySelector('.loader')\nlet btn_load = document.querySelector('.btn')\nlet query = ''\nlet currentPage = 1;\n\nform.addEventListener('submit', handleSubmit)\nbtn_load.addEventListener('click', handleClick)\n\nfunction showElement(element) {\n    element.style.display = 'block'\n}\n\nfunction hideElement(element) {\n    element.style.display = 'none'\n}\n\nasync function handleSubmit(evt) {\n    evt.preventDefault()\n\n    showElement(loader)\n    query = input.value.trim()\n    gallery.innerHTML = ''\n    currentPage = 1;\n    resetPage()\n\n        try {\n        const data = await request(query, currentPage)\n\n        if (data.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: \"bottomRight\"\n            });\n            hideElement(btn_load)\n            return\n        } \n\n        renderGallery(data);\n\n        \n\n        if (page <= totalPages) {\n            showElement(btn_load)\n        } else {\n            hideElement(btn_load)\n        }\n\n        currentPage += 1;\n\n    } catch (err) {\n        console.error(err)\n    } finally {\n        hideElement(loader)\n    }\n\n    form.reset()\n}\n\nasync function handleClick() {\n    showElement(loader)\n\n\n    try {\n        const data = await request(query, currentPage)\n\n        if (!data.length) {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"bottomRight\"\n            })\n            hideElement(btn_load)\n            return\n        }\n\n        renderGallery(data);\n\n\n        scroll()\n\n        if(page > totalPages) {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"bottomRight\"\n            })\n            hideElement(btn_load)\n        }\n\n        currentPage += 1;\n\n    } catch (err) {\n        console.error(err)\n    } finally {\n        hideElement(loader)\n    }\n}\n\nfunction scroll() {\n    const pic = document.querySelectorAll('.pic');\n\n\n    if (pic.length > 0) {\n        const rect = pic[0].getBoundingClientRect().height; \n\n        window.scrollBy({\n            top: rect * 2, \n            behavior: 'smooth' \n        });\n    }\n}\n"],"names":["gallery","lightbox","SimpleLightbox","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","markup","input","page","perPage","totalPages","resetPage","api_key","request","query","currentPage","fetch","axios","totalHits","form","loader","btn_load","handleSubmit","handleClick","showElement","element","hideElement","evt","data","iziToast","err","scroll","pic","rect"],"mappings":"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"}