{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const gallery = document.querySelector('.gallery')\n\nexport default function createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n    `\n    <li class=\"pic\">\n      <a href=\"${largeImageURL}\" target=\"_blank\">\n        <div class=\"pic-card\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"100%\" height=\"220px\"/>\n          <div class=\"info\">\n            <p class=\"info-item\"><b> <span>Likes</span></b> ${likes}</p>\n            <p class=\"info-item\"><b> <span>Views</span></b> ${views}</p>\n            <p class=\"info-item\"><b> <span>Comments</span></b> ${comments}</p>\n            <p class=\"info-item\"><b> <span>Downloads</span></b> ${downloads}</p>\n          </div>\n        </div>\n      </a>\n    </li>\n    `\n    ).join(''); \n}","import axios from \"axios\"\nimport createMarkup, { gallery } from './render-functions.js';\n\nexport const input = document.querySelector('.input')\nexport let page = 1\nexport let perPage = 40\nexport let totalPages = 0\n\nexport function resetPage() {\n    page = 1\n}\n\n\nexport default async function request(query) {\n    if(!query) {\n        return Promise.resolve([])\n    }\n\n    try {\n    const fetch = await axios.get('https://pixabay.com/api/', {\n        params: {\n        key: '48786073-6183322621e5d0cfd6fc221bb',\n        q: query.toLowerCase(),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage\n        }\n    })\n\n    const totalHits = fetch.data.totalHits\n    totalPages = Math.ceil(totalHits / perPage)\n\n     if (page > totalPages) {\n      return []\n    }\n\n    page += 1\n    return fetch.data.hits\n} catch(err)  {\n        return []\n}\n}","import request, { input, page, perPage, totalPages, resetPage } from \"./js/pixabay-api.js\";\nimport createMarkup, { gallery } from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst button = document.querySelector('.button')\nconst form = document.querySelector('.form')\nconst loader = document.querySelector('.loader')\nlet lightbox = new SimpleLightbox('.gallery a')\nlet btn = document.querySelector('.btn')\nlet query = ''\n\nform.addEventListener('submit', handleSubmit)\nbtn.addEventListener('click', handleClick)\n\n\nasync function handleSubmit(evt) {\n    evt.preventDefault()\n\n    loader.style.display = 'block'\n    query = input.value.trim()\n    gallery.innerHTML = ''\n    resetPage()\n\n        try {\n        const data = await request(query)\n\n        if (data.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: \"bottomRight\"\n            });\n            btn.style.display = 'none'\n            return\n        } \n\n        gallery.insertAdjacentHTML('beforeend', createMarkup(data));\n        lightbox.refresh(); \n\n\n        if (page > 1) {\n            btn.style.display = 'block'\n        }\n\n\n    } catch (err) {\n        console.error(err)\n    } finally {\n        loader.style.display = 'none'\n    }\n\n    form.reset()\n}\n\nasync function handleClick() {\n    loader.style.display = 'block'\n\n\n    try {\n        const data = await request(query)\n\n        if (!data.length) {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"bottomRight\"\n            })\n            btn.style.display = 'none'\n        }\n\n        gallery.insertAdjacentHTML('beforeend', createMarkup(data))\n        lightbox.refresh()\n\n        scroll()\n\n        if((page - 1) >= totalPages) {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"bottomRight\"\n            })\n            btn.style.display = 'none'\n        }\n\n    } catch (err) {\n        console.error(err)\n    } finally {\n        loader.style.display = 'none'\n    }\n}\n\nfunction scroll() {\n    const pic = document.querySelectorAll('.pic');\n\n\n    if (pic.length > 0) {\n        const rect = pic[0].getBoundingClientRect().height; \n\n        window.scrollBy({\n            top: rect * 2, \n            behavior: 'smooth' \n        });\n    }\n}\n"],"names":["gallery","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","input","page","perPage","totalPages","resetPage","request","query","fetch","axios","totalHits","form","loader","lightbox","SimpleLightbox","btn","handleSubmit","handleClick","evt","data","iziToast","err","scroll","pic","rect"],"mappings":"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"}